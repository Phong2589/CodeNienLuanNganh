<div class="mt-3 mb-3">
    <div class="row mb-3">
        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-xs-12">
            <img src="{{product.image}}" alt="" class="imageDetailProduct w-100">
        </div>

        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-xs-12">
            <div class="nameDetailProduct">{{product.name}}</div>
            <div class="">{{product.description}}</div>
            <div class="">Số lượng: {{product.quantity}}</div>
            <div class="">Đã bán: 20</div>
            <table class="buyProduct w-100">
                <tr>
                    <td>
                        Đặt hàng sản phẩm
                    </td>
                </tr>

                <tr>
                    <td style="display: block;">
                        <div class=""><span>Giá sản phẩm: </span><span class="number">{{product.cost}}</span></div>
                    </td>

                    <td style="display: block;" class="d-flex justify-content-center">
                        <div class=""><button class="btn btn-danger">Mua ngay</button></div>&nbsp;&nbsp;
                        <div class=""><a onclick="addToCart('{{product.slug}}','{{product.name}}')"><button class="btn btn-primary"><i
                                        class="fas fa-cart-plus"></i> Thêm vào giỏ</button></a></div>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div class="">
        <div class="" style="border-bottom: 4px solid rgb(88, 85, 241); font-size: 25px;">
            SẢN PHẨM KHÁC
        </div>
    </div>
    <div class="row mt-3">
        {{#each products}}
        <a href="/{{this.slug}}" class="col-xl-3 col-lg-3 col-md-4 col-sm-6 col-12 linkItemProduct">
            <div class="itemProduct">
                <img class="w-100 imageProduct" src="{{this.image}}" alt="Lỗi không thể tải ảnh">
                <div class="textProduct">
                    <h5 class="nameProduct">{{this.name}}</h5>
                    <div class="d-flex justify-content-between">
                        <span class="number">{{this.cost}}</span>
                        <span>Đã bán: 100</span>
                    </div>
                </div>
            </div>
        </a>
        {{/each}}
    </div>

</div>

<script>
    window.onload = function () {
        changeNumber();
    };

    function changeNumber() {
        var numberChange = document.getElementsByClassName("number");
        for (x = 0; x < numberChange.length; x++) {
            var cost = parseInt(numberChange[x].innerHTML)

            const change = new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND',
            })
            numberChange[x].innerHTML = change.format(cost)
        }
    };

    function addToCart(slug,name) {
        var xmlhttp;
        xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                var quantity = parseInt(xmlhttp.responseText);
                localStorage.setItem('quantityCart', quantity);
                document.getElementById('cartQuantity').innerHTML = quantity;
                Swal.fire(
                    'Sản phẩm '+name+' đã được thêm vào giỏ hàng!',
                    '<a href="/cart" style="text-decoration: none;">Xem giỏ hàng để biết thêm!<a>',
                    'success'
                );
            }
        }
        xmlhttp.open("GET", "/addProductToCart/" + slug, true);
        xmlhttp.send();

    }
</script>